(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{534:function(e,s,t){"use strict";t.r(s);var i=t(134),a=(t(96),t(7),t(21),t(24),t(512),t(468),{name:"ImageCompress",data:function(){return this.MAX_SIZE=4194304,this.ACCEPT=["image/png","image/jpg","image/jpeg"],this.MAXSIZE_STR="4MB",{fileSize:0,base64Size:0,compressBase64Size:0,compressBlobSize:0,srcList:[]}},methods:{onChange:function(e){var s=this,t=Object(i.a)(e.target.files,1)[0],a=t.type;this.fileSize=t.size,this.ACCEPT.indexOf(a)<0?this.$message.error("不支持上传".concat(a,"类型文件")):this.fileSize>this.MAX_SIZE?this.$message.error("文件超出".concat(this.MAXSIZE_STR,"!")):this.convertImageToBase64(t,(function(e){s.compress(e,s.uploadToServer)}))},convertImageToBase64:function(e,s){var t=new FileReader,i=this;t.addEventListener("load",(function(e){var a=e.target.result;i.base64Size=a.length,i.$set(i.srcList,0,a),t=null,s&&s(a)})),t.readAsDataURL(e)},compress:function(e,s){var t=this,i=new Image;i.src=e,i.addEventListener("load",(function(e){var a=1024,r=1024,n=!1,o=i.naturalWidth,c=i.naturalHeight;a<o&&(n=!0,r=c/(o/a)),r<c&&!n&&(n=!0,a=o/(c/r)),n||(a=o,r=c);var l=document.createElement("canvas"),m=l.getContext("2d");l.width=a,l.height=r,m.drawImage(i,0,0,a,r);var g=l.toDataURL("image/png",.9);s&&s(g),t.$set(t.srcList,1,g),t.compressBase64Size=g.length,l.toBlob((function(e){t.$set(t.srcList,2,URL.createObjectURL(e)),t.compressBlobSize=e.size}),"image/png",.9),i=null,l=null,m=null}))},uploadToServer:function(e){console.log("upload to server...".concat(e))}}}),r=t(40),n=Object(r.a)(a,(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("el-card",[t("input",{attrs:{type:"file"},on:{change:e.onChange}}),e._v(" "),t("div",[t("h3",[e._v("\n      原图: 文件大小："+e._s(e._f("fileSizeFormat")(e.fileSize))+", base64格式大小："+e._s(e._f("fileSizeFormat")(e.base64Size))+"\n    ")]),e._v(" "),t("el-image",{attrs:{src:e.srcList[0],"preview-src-list":e.srcList}})],1),e._v(" "),t("div",[t("h3",[e._v("\n      base64压缩后的图片: 大小："+e._s(e._f("fileSizeFormat")(e.compressBase64Size))+",\n      压缩比："+e._s(e.base64Size/e.compressBase64Size)+"\n    ")]),e._v(" "),t("el-image",{attrs:{src:e.srcList[1],"preview-src-list":e.srcList}}),e._v(" "),t("h3",[e._v("\n      Blob压缩后的图片 大小："+e._s(e._f("fileSizeFormat")(e.compressBlobSize))+",\n      压缩比："+e._s(e.fileSize/e.compressBlobSize)+"\n    ")]),e._v(" "),t("el-image",{attrs:{src:e.srcList[2],"preview-src-list":e.srcList}})],1)])}),[],!1,null,null,null);s.default=n.exports}}]);